<template>
  <div class="">
    <select
      ref="selectRef"
      data-choicepriceproductread=""
      name="product_id"
      required=""
      data-label="Pointure"
      class="hidden"
    >
      <option value="">
        Pointure
      </option>
      <option
        value="2037389"
        data-crossdock="0"
        data-label="40.1/2"
        data-stock-label="C'est le dernier, dépêchez vous !"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        40.1/2
      </option>
      <option
        value="1840817"
        data-crossdock="0"
        data-label="41"
        data-stock-label="Vite plus que 5 en stock !"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        41
      </option>
      <option
        value="1840105"
        data-crossdock="0"
        data-label="42"
        data-stock-label="En stock"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        42
      </option>
      <option
        value="1840381"
        data-crossdock="0"
        data-label="42.1/2"
        data-stock-label="En stock"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        42.1/2
      </option>
      <option
        value="1840204"
        data-crossdock="0"
        data-label="43"
        data-stock-label="En stock"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        43
      </option>
      <option
        value="1840906"
        data-crossdock="0"
        data-label="44"
        data-stock-label="En stock"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        44
      </option>
      <option
        value="1840340"
        data-crossdock="0"
        data-label="44.1/2"
        data-stock-label="En stock"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        44.1/2
      </option>
      <option
        value="1840818"
        data-crossdock="0"
        data-label="45"
        data-stock-label="En stock"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        45
      </option>
      <option
        value="1840925"
        data-crossdock="0"
        data-label="45.1/2"
        data-stock-label="Vite plus que 3 en stock !"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        45.1/2
      </option>
      <option
        value="1840536"
        data-crossdock="0"
        data-label="46"
        data-stock-label="Vite plus que 3 en stock !"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        46
      </option>
      <option
        value="1840075"
        data-crossdock="0"
        data-label="46.1/2"
        data-stock-label="Vite plus que 2 en stock !"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        46.1/2
      </option>
      <option
        value="2037107"
        data-crossdock="0"
        data-label="47.1/2"
        data-stock-label="C'est le dernier, dépêchez vous !"
        data-nostocksubtext="Commandez en ligne, livré demain"
        data-stock="{'shops' : { 'stock' : 0, 'label' : 'Epuisé' } }"
        data-price="170,00"
        data-product-type="1"
        data-is-on-sale="0"
        data-delivery-date="Chez vous <strong>dès samedi</strong> "
      >
        47.1/2
      </option>
    </select>
  </div>
  <n-select
    :options="options"
    option-label="label"
  >
    <template
      #option="{ option }"
    >
      <option-item-size :item="option" />
    </template>
  </n-select>
</template>

<script>
import { nextTick, onMounted, ref } from 'vue'
import NSelect from './NSelect.vue'
import OptionItemSize from './OptionItemSize.vue'

export default {
  name: 'SelectParse',
  components: { OptionItemSize, NSelect },
  setup () {
    const selectRef = ref(null)
    const options = ref([])

    const getOptions = () => {
      const arrayOptions = [...selectRef.value.options]
      for (const item of arrayOptions) {
        if (item.dataset.label) options.value.push(JSON.parse(JSON.stringify(item.dataset)))
      }
    }

    onMounted(async () => {
      await nextTick()
      await getOptions()
    })

    return {
      selectRef,
      options
    }
  }
}
</script>
